{% extends popup|yesno:"django_documentos/documento_create_popup_base.html,django_documentos/base.html" %}
{#{% extends popup %}#}

{#{% extends "django_documentos/base.html" %}#}
{% load bootstrap3 staticfiles %}

{#{% block titulo %}#}
{#    Criar Documento#}
{#{% endblock titulo %}#}


{% block conteudo_app %}
    {{ block.super }}
    {% if form %}
        <a id="teste" href="{% url 'documentos:create' %}{% if popup %}?popup=1{% endif %}">Verifique a Validade</a>
        <div id="codigo_qr"></div>
        <form action="{% url 'documentos:create' %}{% if popup or next_url%}?{% endif %}{% if popup %}popup=1{% endif %}{% if next_url %}&{{ next_kwarg }}={{ next_url }}{% endif %}" method="post" name="documento_create">
            {% csrf_token %}

            {% if form.non_field_errors %}
                {{ form.non_field_errors }}
            {% endif %}

            {{ form.as_p }}

{#            {% bootstrap_form_errors form %}#}
{#            {% bootstrap_form form %}#}
{#            {% if inlines %}#}
{#                {% for formset in inlines %}#}
{#                    <div id="formset-{{ forloop.counter|stringformat:"05d" }}">#}
{#                        {% bootstrap_formset_errors formset %}#}
{#                        {% bootstrap_formset formset %}#}
{#                    </div>#}
{#                {% endfor %}#}
{#            {% endif %}#}
{#            {% buttons %}#}
{#                <button type="submit" class="btn btn-primary">#}
{#                    Submit#}
{#                </button>#}
{#            {% endbuttons %}#}
        <input type="submit" value="Submit">
        </form>

    {% endif %}

{% endblock conteudo_app %}
{% block js_app %}
    {{ block.super }}

    {% if form.media %}
        {{ form.media }}
    {% endif %}
    {% if popup %}
        <script>
            {#        window.onunload = function () {#}
            {#            if (window.opener && !window.opener.closed) {#}
            {#                //window.opener.popUpClosed("Mááááá oiiiiiii");#}
            {#                window.opener.mais_que("http://www.google.com.br");#}
            {#            }#}
            {#        };#}
            function OnClose() {
                "use strict";
                if (window.opener != null && !window.opener.closed) {
                    window.opener.HideModalDiv('vaiFuncionar');
                    window.opener.redirecionar('vaiFuncionar');
                }
            }
            window.onunload = OnClose;

        </script>
    {% endif %}

    <script type="text/javascript" src="{% static "django_documentos/js/autosize.js" %}"></script>
    <script src="{% static 'django_documentos/js/jquery.qrcode.min.js' %}"></script>
    <script>
        autosize(document.querySelectorAll('textarea'));
        var teste = $("#teste");
        var opcoes = {
            // render method: 'canvas', 'image' or 'div'
            render: 'canvas',

            // version range somewhere in 1 .. 40
            minVersion: 1,
            maxVersion: 40,

            // error correction level: 'L', 'M', 'Q' or 'H'
            ecLevel: 'H',

            // offset in pixel if drawn onto existing canvas
            left: 0,
            top: 0,

            // size in pixel
            size: 100,

            // code color or image element
            fill: '#000',

            // background color or image element, null for transparent background
            background: null,

            // content
            text: teste.attr("href"),

            // corner radius relative to module width: 0.0 .. 0.5
            radius: 0.5,

            // quiet zone in modules
            quiet: 0,

            // modes
            // 0: normal
            // 1: label strip
            // 2: label box
            // 3: image strip
            // 4: image box
            mode: 2,

            mSize: 0.1,
            mPosX: 0.5,
            mPosY: 0.5,

            label: 'Solar',
            fontname: 'sans',
            fontcolor: '#ff8300',

            image: null
        };

        $("#codigo_qr").qrcode(opcoes);
    </script>
{% endblock %}
