CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(Array.prototype.indexOf=function(a,d){for(var b=d||0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1});function cleanAttribute(a){var d=["width","style","moz_resizing","colspan","rowspan"];if(a.nodeName=="TABLE"){d.push("class");d.push("border")}else d.push("align");var b=[],a=a.attributes,c=a.length;if(c>0){for(var e=0;e<c;e++)d.indexOf(a[e].name.toLowerCase())==-1&&b.push(a[e].name);for(d=0;d<b.length;d++)a.removeNamedItem(b[d])}}
function cleanStyle(a){var d=["width","font-family","font-size","font-weight","text-align","border-spacing","nowrap"],b=[],a=a.style,c=a.length;if(CKEDITOR.env.ie&&CKEDITOR.env.version<9)if(a.cssText.length==0)c=0;else var e=a.cssText.split(";"),c=e.length;var f;if(c>0){for(var g=0;g<c;g++)if(e){f=e[g].split(":")[0].toLowerCase();d.indexOf(f)!=-1&&b.push(e[g])}else{f=a[g];d.indexOf(f)==-1&&b.push(f)}if(e)a.cssText=b.join(";");else for(d=0;d<b.length;d++)a.removeProperty(b[d])}}
function cleanTable(a){if(a.nodeName=="TABLE"){CKEDITOR.env.ie?cleanElement(a.children[0]):cleanElement(a.firstElementChild);cleanAttribute(a);cleanStyle(a)}}
function cleanElement(a){if(["THEAD","TBODY","TR","TD","TH"].indexOf(a.nodeName)!=-1){cleanAttribute(a);cleanStyle(a);if(CKEDITOR.env.ie){a.children[0]!=null&&cleanElement(a.children[0]);a.nextSibling!=null&&cleanElement(a.nextSibling)}else{a.firstElementChild!=null&&cleanElement(a.firstElementChild);a.nextElementSibling!=null&&cleanElement(a.nextElementSibling)}}}
CKEDITOR.plugins.add("tableclean",{requires:["table"],init:function(a){a.addCommand("tableClearFormat",{exec:function(a){var a=a.getSelection(),b=a.getRanges(),c=null;if(c=a.getSelectedElement())c=c.getAscendant("table",true);else if(b.length>0){CKEDITOR.env.webkit&&b[0].shrink(CKEDITOR.NODE_ELEMENT);c=b[0].getCommonAncestor(true).getAscendant("table",true)}this._.selectedElement=c;cleanTable(c.$);c.setAttribute("border","1");c.removeClass("cke_show_border")}});a.addMenuItems&&a.addMenuItems({tableclean:{label:"Limpar Formatação",
command:"tableClearFormat",group:"table",order:4}});a.contextMenu&&a.contextMenu.addListener(function(a){return!a||a.isReadOnly()?null:a.hasAscendant("table",1)?{tableclean:CKEDITOR.TRISTATE_OFF}:null})}});